{% extends "base.html" %}

{% block content %}
<!-- Page Header -->
    <h1 class="page-header"> {{ fb_name }}</h1>

    <form method="POST">
        {% if not is_fav and current_user.is_authenticated %}
        <button style="background: transparent; border: 0" type=submit name="action" value="add" class="fav"> <img src="../static/unsaved.png" alt="not saved" width="40" height="40"></button>
        {% elif is_fav%}
        <button style="background: transparent; border: 0" type=submit name="action" value="remove" class="fav"> <img src="../static/saved.png" alt="saved" width="40" height="40"></button>
        {% endif %}
    </form>


<div id='map'>

    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css' rel='stylesheet' />
    <script  type='text/javascript' src="../static/config.js"></script>
<script>

mapboxgl.accessToken = config.MAPBOX_API_TOKEN;

const lat = {{ lat|safe }};
const long = {{ long|safe }};

const map = new mapboxgl.Map({
  container: 'map',
  style: 'mapbox://styles/mapbox/streets-v10',
  center: [long, lat],
  zoom: 14
});

var msg = {{fb_name|tojson}};

const popup = new mapboxgl.Popup({offset: 25}).setText(msg);
const marker = new mapboxgl.Marker().setLngLat([long, lat]).setPopup(popup).addTo(map);
</script>
    </div>

<div class="high-stock">
High in stock:
{{ 'Starchy foods' if fb_stock.starchy > fb_stock.starchy_high }}
{{ 'Proteins' if fb_stock.protein > fb_stock.protein_high }}
{{ 'Fruit and vegetables' if fb_stock.fruit_veg > fb_stock.fruit_veg_high }}
{{ 'Soups' if fb_stock.soup_sauce > fb_stock.soup_sauce_high }}
{{ 'Drinks' if fb_stock.drinks > fb_stock.drinks_high }}
{{ 'Snacks' if fb_stock.snacks > fb_stock.snacks_high }}
{{ 'Cooking ingredients' if fb_stock.cooking_ingredients > fb_stock.cooking_ingredients_high }}
{{ 'Condiments' if fb_stock.condiments > fb_stock.condiments_high }}
{{ 'Toiletries' if fb_stock.toiletries > fb_stock.toiletries_high }}
</div>

<div class="low-stock">
Low in stock:
{{ 'Starchy foods' if fb_stock.starchy < fb_stock.starchy_low }}
{{ 'Proteins' if fb_stock.protein < fb_stock.protein_low }}
{{ 'Fruit and vegetables' if fb_stock.fruit_veg < fb_stock.fruit_veg_low }}
{{ 'Soups' if fb_stock.soup_sauce < fb_stock.soup_sauce_low }}
{{ 'Drinks' if fb_stock.drinks < fb_stock.drinks_low }}
{{ 'Snacks' if fb_stock.snacks < fb_stock.snacks_low }}
{{ 'Cooking ingredients' if fb_stock.cooking_ingredients < fb_stock.cooking_ingredients_low }}
{{ 'Condiments' if fb_stock.condiments < fb_stock.condiments_low }}
{{ 'Toiletries' if fb_stock.toiletries < fb_stock.toiletries_low }}
</div>

    <div class="fb-contact-details">
        <h4> Contact details: </h4>
        <p> Email:  {{ fb_email }} </p>
        <p> Phone number: {{ fb_phone }} </p>
    <p> Website: {{ fb_web if fb_web is not none else 'Not Avaialble'}} </p>

    </div>
{% endblock %}